<project name="native-build" default="do-deploy" basedir="."  xmlns:fx="javafx:com.sun.javafx.tools.ant">
	<property name="eclipse-app-dir" value="../org.eclipse.emf.ecp.application.e4.fx.product/target/products/org.eclipse.emf.ecp.application.e4.fx.product/noenv/noenv/noenv" />
	
	<target name="init-fx-tasks">
		<taskdef name="fxosgilauncher" classpath="org.eclipse.fx.ide.ant.jar" classname="org.eclipse.fx.ide.ant.FXOsgiLaunchTask" />
		<path id="fxant">
			<filelist>
				<file name="${java.home}\..\lib\ant-javafx.jar"/>
				<file name="${java.home}\..\jre\lib\jfxrt.jar"/>
				<file name="${java.home}\lib\ant-jfxrt.jar"/>
				<!--
				<file name="${java.home}\..\jdk1.7.0_51\lib\ant-jfxrt.jar"/>
				-->
				<file name="${java.home}\..\jdk1.7.0_51\lib\ant-javafx.jar"/>
			</filelist>
		</path>
		<!--
		<available property="file1.exists" file="${java.home}\..\lib\ant-javafx.jar"/>
		<echo message="..\lib\ant-javafx.jar exists: ${file1.exists}"/>
		<available property="file11.exists" file="${java.home}\..\jre\lib\jfxrt.jar"/>
				<echo message="..\jre\lib\jfxrt.jar exists: ${file11.exists}"/>
		<available property="file2.exists" file="${java.home}\lib\ant-jfxrt.jar"/>
				<echo message="\lib\ant-jfxrt.jar exists: ${file2.exists}"/>
		<available property="file3.exists" file="${java.home}\..\jdk1.7.0_51\lib\ant-jfxrt.jar"/>
				<echo message="..\jdk1.7.0_51\lib\ant-jfxrt.jar exists: ${file3.exists}"/>
		<available property="file4.exists" file="${java.home}\..\jdk1.7.0_51\lib\ant-javafx.jar"/>
				<echo message="..\jdk1.7.0_51\lib\ant-javafx.jar exists: ${file4.exists}"/>
		-->
		<taskdef resource="com/sun/javafx/tools/ant/antlib.xml"      
					uri="javafx:com.sun.javafx.tools.ant"
					
			classpathref="fxant"/>
	</target>
		
	<target name="do-deploy" depends="init-fx-tasks">
		<fileset id="equinox-launcher" dir="../org.eclipse.emf.ecp.application.e4.fx.product/target/products/org.eclipse.emf.ecp.application.e4.fx.product/noenv/noenv/noenv">
			<filename name="plugins/org.eclipse.equinox.launcher_*.jar"/>
		</fileset>
		<echo message="EquinoxLauncher ${toString:equinox-launcher}" />
		<fxosgilauncher classpathref="fxant" equinoxlauncherjarref="equinox-launcher"/>
	
		<fx:resources id="appRes">
			<fx:fileset dir="." includes="fx-osgi-launch.jar"/>
			<fx:fileset dir="${eclipse-app-dir}" includes="**/*"/>
		</fx:resources>
		
		<fx:application id="fxApplication"
								name="ECP e4 FX Demo"
								mainClass="org.eclipse.equinox.launcher.Main"
								toolkit="swing"
						
							/>
		
		<fx:deploy
			embedJNLP="false"
			extension="false"
			includeDT="false"
			offlineAllowed="true"
			outdir="${basedir}/deploy"
			outfile="fix-ide" 
			nativeBundles="all"
			updatemode="background"
		verbose="true" 
			>
			
			<fx:info title="ECP e4 FX Demo" vendor="Eclipse Modeling Project"/>
			<fx:application refid="fxApplication"/>
			<fx:resources refid="appRes"/>
		</fx:deploy>
	</target>
</project>